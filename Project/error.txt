import matplotlib.pyplot as plt

# Aggregate the count of defaults and non-defaults
default_counts = data.groupBy('default_label').count()

# Convert to Pandas DataFrame for plotting
default_counts_pandas = default_counts.toPandas()

# Rename the default_label for clarity in the plot
default_counts_pandas['default_label'] = default_counts_pandas['default_label'].map({0: 'Did Not Default', 1: 'Defaulted'})

# Now use matplotlib to plot, with the Pandas DataFrame
plt.bar(default_counts_pandas['default_label'], default_counts_pandas['count'], alpha=0.8)
plt.title('Frequency of Defaults in Dataset')
plt.ylabel('Frequency')
plt.xlabel('Default Status')
plt.xticks(rotation=45)  # Rotate x-axis labels if necessary
plt.show()
